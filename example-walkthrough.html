
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="lprolog.html">
      
      
      
      <link rel="icon" href="assets/logo/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.21">
    
    
      
        <title>Example - Distributed Assertion Management Framework</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.66ac8b77.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"M PLUS Rounded 1c";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/css/extra.css">
    
      <link rel="stylesheet" href="assets/css/collapsible.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#example-walkthrough" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="Distributed Assertion Management Framework" class="md-header__button md-logo" aria-label="Distributed Assertion Management Framework" data-md-component="logo">
      
  <img src="assets/logo/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Distributed Assertion Management Framework
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Example
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label=":Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title=":Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 9.47V11h3.76L13 14.53V13H9.24L11 9.47M13 1 6 15h5v8l7-14h-5V1Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11 15H6l7-14v8h5l-7 14v-8Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="index.html" class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="damf-formats.html" class="md-tabs__link">
          
  
  Design

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="dispatch.html" class="md-tabs__link">
        
  
    
  
  Dispatch

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="abella.html" class="md-tabs__link">
          
  
  Edge Systems

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="example-walkthrough.html" class="md-tabs__link">
        
  
    
  
  Example

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="Distributed Assertion Management Framework" class="md-nav__button md-logo" aria-label="Distributed Assertion Management Framework" data-md-component="logo">
      
  <img src="assets/logo/logo.png" alt="logo">

    </a>
    Distributed Assertion Management Framework
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Design
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Design
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="damf-formats.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DAMF Formats
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="damf-processes.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Processes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="dispatch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dispatch
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Edge Systems
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Edge Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="abella.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abella DAMF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lprolog.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    λProlog
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Example
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="example-walkthrough.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Example
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-local-ipfs-client" class="md-nav__link">
    <span class="md-ellipsis">
      1. Local IPFS client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-dispatch-agent-profile" class="md-nav__link">
    <span class="md-ellipsis">
      2. Dispatch, agent profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lemma-in-coq" class="md-nav__link">
    <span class="md-ellipsis">
      Lemma in Coq
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lemma in Coq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-full-proof" class="md-nav__link">
    <span class="md-ellipsis">
      3. Full proof
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-language-and-tool-objects" class="md-nav__link">
    <span class="md-ellipsis">
      4. Language and Tool objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-the-damf-assertions" class="md-nav__link">
    <span class="md-ellipsis">
      5. The DAMF assertions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computations-with-prolog" class="md-nav__link">
    <span class="md-ellipsis">
      Computations with λProlog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Computations with λProlog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-logic-programming" class="md-nav__link">
    <span class="md-ellipsis">
      6. Logic programming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-exporting-to-damf" class="md-nav__link">
    <span class="md-ellipsis">
      7. Exporting to DAMF
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#theorem-in-abella-damf" class="md-nav__link">
    <span class="md-ellipsis">
      Theorem in Abella DAMF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theorem in Abella DAMF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8-setting-the-stage" class="md-nav__link">
    <span class="md-ellipsis">
      8. Setting the stage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-importing-damf-assertions" class="md-nav__link">
    <span class="md-ellipsis">
      9. Importing DAMF assertions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-finishing-the-theorem" class="md-nav__link">
    <span class="md-ellipsis">
      10. Finishing the theorem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-local-ipfs-client" class="md-nav__link">
    <span class="md-ellipsis">
      1. Local IPFS client
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-dispatch-agent-profile" class="md-nav__link">
    <span class="md-ellipsis">
      2. Dispatch, agent profile
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lemma-in-coq" class="md-nav__link">
    <span class="md-ellipsis">
      Lemma in Coq
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lemma in Coq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#3-full-proof" class="md-nav__link">
    <span class="md-ellipsis">
      3. Full proof
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-language-and-tool-objects" class="md-nav__link">
    <span class="md-ellipsis">
      4. Language and Tool objects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-the-damf-assertions" class="md-nav__link">
    <span class="md-ellipsis">
      5. The DAMF assertions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#computations-with-prolog" class="md-nav__link">
    <span class="md-ellipsis">
      Computations with λProlog
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Computations with λProlog">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#6-logic-programming" class="md-nav__link">
    <span class="md-ellipsis">
      6. Logic programming
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-exporting-to-damf" class="md-nav__link">
    <span class="md-ellipsis">
      7. Exporting to DAMF
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#theorem-in-abella-damf" class="md-nav__link">
    <span class="md-ellipsis">
      Theorem in Abella DAMF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Theorem in Abella DAMF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#8-setting-the-stage" class="md-nav__link">
    <span class="md-ellipsis">
      8. Setting the stage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-importing-damf-assertions" class="md-nav__link">
    <span class="md-ellipsis">
      9. Importing DAMF assertions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-finishing-the-theorem" class="md-nav__link">
    <span class="md-ellipsis">
      10. Finishing the theorem
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="example-walkthrough">Example Walkthrough</h1>
<p>This walkthrough shows how to use a combination of DAMF-aware edge systems to
verify and subsequently publish the following assertion:</p>
<div class="admonition success">
<p><strong>Theorem.</strong> For <span class="arithmatex">\(n \in \mathbb{N}\)</span>, <span class="arithmatex">\(\kop{fib}(n) = n^2\)</span> if and only if <span class="arithmatex">\(n \in
\{0, 1, 12\}\)</span>, where <span class="arithmatex">\(\kop{fib}(n)\)</span> stands for the <span class="arithmatex">\(n\)</span>th Fibonacci
number defined as:
<span class="arithmatex">\(\kop{fib}(0) \triangleq 0\)</span>,
<span class="arithmatex">\(\kop{fib}(1) \triangleq 1\)</span>, and
<span class="arithmatex">\(\kop{fib}(n + 2) \triangleq \kop{fib}(n + 1) + \kop{fib}(n)\)</span>.</p>
</div>
<p>In the <em>if</em> direction, the assertion is fairly easy to prove in any system that
can support inductive definitions such as <span class="arithmatex">\(\kop{fib}\)</span> in the first place: one
just has to compute <span class="arithmatex">\(\kop{fib}(0)\)</span>, <span class="arithmatex">\(\kop{fib}(1)\)</span>, and <span class="arithmatex">\(\kop{fib}(12)\)</span> and
verify that they are indeed <span class="arithmatex">\(0\)</span>, <span class="arithmatex">\(1\)</span>, and <span class="arithmatex">\(144\)</span>, respectively. The <em>only if</em>
direction, on the other hand, requires the ability to reason about the growth of
the Fibonacci function with respect to the quadratic function <span class="arithmatex">\(n \mapsto n^2\)</span>.
In particular, one needs the following lemma:</p>
<div class="admonition tip">
<p><strong>Lemma.</strong> For <span class="arithmatex">\(n \in \mathbb{N}\)</span>, if <span class="arithmatex">\(n \ge 13\)</span>, then <span class="arithmatex">\(\kop{fib}(n) &gt; n^2\)</span>.</p>
</div>
<p>This walkthrough will perform this verification task using the following
heterogeneous collection of systems:</p>
<ul>
<li><a href="abella.html">Abella DAMF</a> for the overall theorem</li>
<li><a href="https://coq.inria.fr">Coq</a> to prove the lemma</li>
<li><a href="lprolog.html">λProlog</a> to illustrate how to incorporate logic programming</li>
</ul>
<h2 id="setup">Setup</h2>
<h3 id="1-local-ipfs-client">1. Local IPFS client</h3>
<p><a href="index.html">DAMF</a> is built on top of IPFS and IPLD, so you will need an IPFS client. For
this walkthrough we will use the <a href="dispatch.html">Dispatch</a> intermediary, which
requires the <a href="https://github.com/ipfs/kubo">IPFS Kubo</a> command line program, a Go-based implementation of the InterPlanetary File System (IPFS) protocol, accessed via the command <code>ipfs</code>. The version used in this walkthrough is <code>ipfs version 0.28.0</code>.</p>
<ul>
<li><a href="https://docs.ipfs.tech/install/command-line/">Installation instructions for Kubo</a></li>
</ul>
<p>You will also need to create your local IPFS repository, usually stored under
<code>$HOME/.ipfs</code> or a similar folder. This is done by issuing the following
command: <code>ipfs init</code>.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>ipfs<span class="w"> </span>init
<span class="go">generating ED25519 keypair...done</span>
<span class="go">peer identity: 12D3KooWNEsJFEp4FM14o9zedmFpBohUA4jPH77WYex75YP6mNHk</span>
<span class="go">initializing IPFS node at /home/ExampleUser/.ipfs</span>
<span class="go">to get started, enter:</span>

<span class="go">    ipfs cat /ipfs/QmQPeNsJPyVWPFDVHb77w8G42Fvo15z4bG2X8D2GhfbSXc/readme</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">IPFS Daemon</p>
<p>Running the IPFS daemon is optional for this walkthrough.
You only need the daemon if you want to disseminate the assertions you
publish into the IPFS network so that other people may use them.
If you leave the daemon off, you will only be able to share assertions
between programs that can access your local IPFS repository.</p>
</div>
<h3 id="2-dispatch-agent-profile">2. Dispatch, agent profile</h3>
<p>In DAMF, each assertion is <em>signed</em> by exactly one <em>agent</em>. Concretely, an
agent is a public-private key pair; the <em>name</em> of the agent is just its
public key.</p>
<p>The <a href="dispatch.html">Dispatch</a> intermediate tool can be used to create an <em>agent
profile</em>, which is just a human-readable string that stands for an agent.  Agent
profile names are <em>not</em> globally shared using IPFS. Indeed, DAMF is completely
unaware of agent profiles.</p>
<p>In this walkthrough, we will create an agent profile called
<code>exampleAgent</code>. Install Dispatch by <a href="dispatch.html#obtaining-and-building">following the
instructions</a>. In the rest of this tutorial,
we will use the command <code>dispatch</code> to stand for whichever Dispatch executable is
relevant to your system. Next, run <code>dispatch create-agent</code>.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>dispatch<span class="w"> </span>create-agent<span class="w"> </span>exampleAgent
<span class="go">Agent profile exampleAgent created successfully!</span>

<span class="gp">$ </span>dispatch<span class="w"> </span>list-config<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>exampleAgent<span class="w"> </span><span class="c1"># (1)!</span>
<span class="go">  exampleAgent: {</span>
<span class="go">    name: &#39;exampleAgent&#39;,</span>
</code></pre></div>
<ol>
<li>Just to verify that it worked.</li>
</ol>
<h2 id="lemma-in-coq">Lemma in Coq</h2>
<p>In order to follow along with this walkthrough, you should <a href="https://coq.inria.fr/download">install Coq
version 8.16.1</a>.</p>
<h3 id="3-full-proof">3. Full proof</h3>
<p>We begin with a traditional (<em>autarkic</em>) mode of usage of Coq, unmodified,
without any connection to DAMF assertions.</p>
<p>As usual, we begin with importing the <code>Arith</code> module to fix the interpretation
of numerals using the <code>nat</code> type, and then capture <span class="arithmatex">\(\kop{fib}\)</span> as the recursive
fixed point function <code>fib</code>.</p>
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibLemma.v</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">Require</span> <span class="kn">Import</span> <span class="n">Arith</span><span class="o">.</span>

<span class="kn">Fixpoint</span> <span class="n">fib</span> <span class="o">(</span><span class="n">n</span><span class="o">:</span> <span class="n">nat</span><span class="o">):</span> <span class="n">nat</span> <span class="o">:=</span>
  <span class="k">match</span> <span class="n">n</span> <span class="k">with</span>
  <span class="o">|</span> <span class="mi">0</span> <span class="o">=&gt;</span> <span class="mi">0</span>
  <span class="o">|</span> <span class="n">S</span> <span class="n">j</span> <span class="o">=&gt;</span>
      <span class="k">match</span> <span class="n">j</span> <span class="k">with</span>
      <span class="o">|</span> <span class="mi">0</span> <span class="o">=&gt;</span> <span class="mi">1</span>
      <span class="o">|</span> <span class="n">S</span> <span class="n">k</span> <span class="o">=&gt;</span> <span class="n">fib</span> <span class="n">j</span> <span class="o">+</span> <span class="n">fib</span> <span class="n">k</span>
      <span class="k">end</span>
  <span class="k">end</span><span class="o">.</span>
</code></pre></div></td></tr></table></div>
<p>We will prove our lemma of interest using the <code>lia</code> tactic of Coq, which is
enabled by the <code>Lia</code> module. We will also pervasively use rewriting modulo
linear arithmetic identities, so we define a Ltac named <code>liarw</code> for convenience.</p>
<div class="continued highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibLemma.v</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">Require</span> <span class="kn">Import</span> <span class="n">Lia</span><span class="o">.</span>

<span class="kn">Ltac</span> <span class="n">liarw</span> <span class="n">F</span> <span class="o">:=</span>
  <span class="k">let</span> <span class="n">h</span> <span class="o">:=</span> <span class="n">fresh</span> <span class="s2">&quot;H&quot;</span> <span class="k">in</span>
  <span class="k">assert</span> <span class="o">(</span><span class="n">h</span><span class="o">:</span> <span class="n">F</span><span class="o">)</span> <span class="kp">by</span> <span class="o">(</span><span class="k">simpl</span><span class="o">;</span> <span class="kp">lia</span><span class="o">);</span> <span class="k">rewrite</span> <span class="n">h</span> <span class="k">in</span> <span class="o">*;</span> <span class="k">clear</span> <span class="n">h</span><span class="o">.</span>
</code></pre></div></td></tr></table></div>
<p>Finally, here is our full proof of the lemma, which is named <code>fib_square_above</code>
here. This lemma itself makes use of a different lemma called <code>fib_square_lemma</code>.</p>
<div class="continued highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibLemma.v</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">Lemma</span> <span class="n">fib_square_lemma</span><span class="o">:</span> <span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">27</span> <span class="o">&lt;=</span> <span class="n">fib</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">12</span><span class="o">).</span>
<span class="kn">Proof</span><span class="o">.</span>
  <span class="k">induction</span> <span class="n">n</span><span class="o">.</span>
  <span class="o">-</span> <span class="k">simpl</span><span class="o">;</span> <span class="kp">lia</span><span class="o">.</span>
  <span class="o">-</span> <span class="n">liarw</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">=</span> <span class="n">S</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">11</span><span class="o">)).</span>
    <span class="n">liarw</span> <span class="o">(</span><span class="n">S</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">12</span> <span class="o">=</span> <span class="n">S</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">11</span><span class="o">))).</span>
    <span class="k">assert</span> <span class="o">(</span><span class="n">Hl</span><span class="o">:</span> <span class="mi">2</span> <span class="o">&lt;=</span> <span class="n">fib</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">11</span><span class="o">)).</span>
      <span class="k">clear</span> <span class="n">IHn</span><span class="o">;</span> <span class="k">induction</span> <span class="n">n</span><span class="o">;</span> <span class="o">[</span><span class="k">simpl</span><span class="o">;</span> <span class="kp">lia</span> <span class="o">|</span> <span class="o">].</span>
      <span class="n">liarw</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">11</span> <span class="o">=</span> <span class="n">S</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">10</span><span class="o">)).</span>
      <span class="n">liarw</span> <span class="o">(</span><span class="n">S</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">11</span> <span class="o">=</span> <span class="n">S</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">10</span><span class="o">))).</span>
      <span class="k">assert</span> <span class="o">(</span><span class="n">H</span><span class="o">:</span> <span class="n">fib</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">10</span><span class="o">)))</span>
                 <span class="o">=</span> <span class="n">fib</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">10</span><span class="o">))</span> <span class="o">+</span> <span class="n">fib</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">10</span><span class="o">))</span> <span class="kp">by</span> <span class="k">auto</span><span class="o">.</span>
      <span class="kp">lia</span><span class="o">.</span>
    <span class="k">assert</span> <span class="o">(</span><span class="n">fib</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">11</span><span class="o">)))</span>
            <span class="o">=</span> <span class="n">fib</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">11</span><span class="o">))</span> <span class="o">+</span> <span class="n">fib</span> <span class="o">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">11</span><span class="o">))</span> <span class="kp">by</span> <span class="k">auto</span><span class="o">.</span>
    <span class="kp">lia</span><span class="o">.</span>
<span class="kn">Qed</span><span class="o">.</span>

<span class="kn">Theorem</span> <span class="n">fib_square_above</span><span class="o">:</span> <span class="k">forall</span> <span class="n">n</span><span class="o">,</span> <span class="mi">13</span> <span class="o">&lt;=</span> <span class="n">n</span> <span class="o">-&gt;</span> <span class="n">n</span> <span class="o">^</span> <span class="mi">2</span> <span class="o">&lt;</span> <span class="n">fib</span> <span class="n">n</span><span class="o">.</span>
<span class="kn">Proof</span><span class="o">.</span>
  <span class="k">intros</span> <span class="n">n</span> <span class="n">Hle</span><span class="o">;</span> <span class="k">pose</span> <span class="o">(</span><span class="n">k</span> <span class="o">:=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">13</span><span class="o">);</span> <span class="n">liarw</span> <span class="o">(</span><span class="n">n</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">13</span><span class="o">);</span> <span class="k">clear</span> <span class="n">Hle</span><span class="o">.</span>
  <span class="k">induction</span> <span class="n">k</span><span class="o">.</span>
  <span class="o">-</span> <span class="k">simpl</span><span class="o">;</span> <span class="kp">lia</span><span class="o">.</span>
  <span class="o">-</span> <span class="n">liarw</span> <span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">13</span> <span class="o">=</span> <span class="n">S</span> <span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">12</span><span class="o">)).</span>
    <span class="n">liarw</span> <span class="o">(</span><span class="n">S</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">13</span> <span class="o">=</span> <span class="n">S</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">12</span><span class="o">))).</span>
    <span class="k">assert</span> <span class="o">(</span><span class="n">fib</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">12</span><span class="o">)))</span>
            <span class="o">=</span> <span class="n">fib</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">12</span><span class="o">))</span> <span class="o">+</span> <span class="n">fib</span> <span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">12</span><span class="o">))</span> <span class="kp">by</span> <span class="k">auto</span><span class="o">.</span>
    <span class="n">liarw</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">S</span> <span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">12</span><span class="o">))</span> <span class="o">^</span> <span class="mi">2</span>
           <span class="o">=</span> <span class="n">S</span> <span class="o">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">12</span><span class="o">)</span> <span class="o">^</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">27</span><span class="o">).</span>
    <span class="n">specialize</span> <span class="o">(</span><span class="n">fib_square_lemma</span> <span class="n">k</span><span class="o">).</span>
    <span class="kp">lia</span><span class="o">.</span>
<span class="kn">Qed</span><span class="o">.</span>
</code></pre></div></td></tr></table></div>
<!-- [Download <tt>FibLemma.v</tt>](/FibLemma.v){ class="md-button" } -->

<h3 id="4-language-and-tool-objects">4. Language and Tool objects</h3>
<p>Let&rsquo;s move on to representng <code>fib_square_lemma</code> and <code>fib_square_above</code> as DAMF
assertions.</p>
<p>To get there, we first have to turn Coq propositions into DAMF formula objects,
for which we will need to supply a suitable <code>language</code> field. As there isn&rsquo;t
(yet!) a universally agreed upon DAMF object to represent this language, we will
create one for the purposes of this walkthrough.</p>
<p>We start by creating a JSON object to represent the <code>content</code> of what a &ldquo;Coq
version 8.16.1&rdquo; language object might contain. Here we could in principle link
to the reference manual that is distributed as part of the Coq 8.16.1
release. We could alternatively, or in addition, place the source or exceutable
code of a Coq parser. In this walkthrough, to simplify matters, we will
represent this language as the following JSON object that just links to the Coq
website.</p>
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Coq.language.content.json</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Coq&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;8.16.1&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://coq.inria.fr&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>We can then use <code>dispatch create-language</code> to make the DAMF language object and
simultaneously give it a local human-readable name, <code>coq-8.16.1</code>.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>dispatch<span class="w"> </span>create-language<span class="w"> </span>coq-8.16.1<span class="w"> </span>json<span class="w"> </span>Coq.language.content.json
<span class="go">Language record coq-8.16.1 created successfully!</span>
</code></pre></div>
<p>If we want to see the DAMF object that was created by Dispatch, we can read its
<code>languages.json</code> configuration file to get its CID, and then use <code>ipfs dag get</code>
to explore the contents of the linked objects in IPLD starting from that CID.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>cat<span class="w"> </span><span class="nv">$HOME</span>/.config/dispatch/languages.json
<span class="go">{&quot;coq-8.16.1&quot;:{&quot;name&quot;:&quot;coq-8.16.1&quot;,&quot;language&quot;:&quot;bafyreigohn2y34l6ks2yqozhstedfxhkitcjjgmhaipeo674ct64vrko2y&quot;}}</span>

<span class="gp">$ </span>ipfs<span class="w"> </span>dag<span class="w"> </span>get<span class="w"> </span>bafyreigohn2y34l6ks2yqozhstedfxhkitcjjgmhaipeo674ct64vrko2y<span class="w"> </span><span class="c1"># (1)!</span>
<span class="go">{&quot;content&quot;:{&quot;name&quot;:&quot;Coq&quot;,&quot;url&quot;:&quot;https://coq.inria.fr&quot;,&quot;version&quot;:&quot;8.16.1&quot;},&quot;format&quot;:&quot;language&quot;}</span>

<span class="gp">$ </span>ipfs<span class="w"> </span>dag<span class="w"> </span>get<span class="w"> </span>bafyreigohn2y34l6ks2yqozhstedfxhkitcjjgmhaipeo674ct64vrko2y/content<span class="w"> </span><span class="c1"># (2)!</span>
<span class="go">{&quot;name&quot;:&quot;Coq&quot;,&quot;url&quot;:&quot;https://coq.inria.fr&quot;,&quot;version&quot;:&quot;8.16.1&quot;}</span>
</code></pre></div>
<ol>
<li>This is the CID found in <code>languages.json</code>.</li>
<li>This is isomorphic to our <code>Coq.language.content.json</code> object.</li>
</ol>
<!-- [Download <tt>Coq.language.content.json</tt>](/Coq.language.content.json){ class="md-button" } -->

<p>We can record that we used Coq v.8.16.1 to verify our proofs of the assertions
by referencing a DAMF tool object in the <code>mode</code> field of the corresponding
production. Like with the language object above, there isn&rsquo;t currently a
standard DAMF tool object to represent this version of the Coq
implementation. Therefore, like with languages above, we will create the content
of such a tool object ourselves for the purposes of this walkthrough.</p>
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">coq-8.16.1.tool.content.json</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Coq&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;8.16.1&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://github.com/coq/coq/archive/refs/tags/V8.16.1.tar.gz&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;sha256&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;583471c8ed4f227cb374ee8a13a769c46579313d407db67a82d202ee48300e4b&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>To create the DAMF tool object, we use <code>dispatch create-tool</code>.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>dispatch<span class="w"> </span>create-tool<span class="w"> </span>coq-8.16.1<span class="w"> </span>json<span class="w"> </span>coq-8.16.1.tool.content.json
<span class="go">Tool profile coq-8.16.1 created successfully!</span>
</code></pre></div>
<!-- [Download <tt>coq-8.16.1.tool.content.json</tt>](/coq-8.16.1.tool.content.json){ class="md-button" } -->

<h3 id="5-the-damf-assertions">5. The DAMF assertions</h3>
<p>There is currently no software that can transform the theorems we have just
proved in Coq into DAMF assertions. We will do this manually. To cause the least
breakage, we will reuse the text of the Coq development as much as possible.</p>
<p>Consider the first lemma, <code>fib_square_lemma</code>. The <em>formula</em> content of this
lemma is the string <code>"forall n, 2 * n + 27 &lt;= fib (n + 12)"</code>. This string,
however, only makes sense in a <em>context</em> where the symbols <code>*</code>, <code>+</code>, <code>&lt;=</code>,
<code>fib</code>, etc. are defined. These symbols come from the Coq standard prelude with
some additional support from the <code>Arith</code> module, except <code>fib</code> which we defined
ourselves. Thus, the DAMF context object for this formula can be built with the
following input for Dispatch:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;context&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// (1)!</span>
<span class="w">  </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;Require Arith&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;Fixpoint fib (n: nat): nat := match … end&quot;</span><span class="w"> </span><span class="c1">// (2)!</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>This is the local name we picked using <code>dispatch create-language</code> in step 4.</li>
<li>Lines 3&ndash;11 of <code>FibLemma.v</code>.</li>
</ol>
<p>In order to build the assertion that corresponds to <code>fib_square_lemma</code>, Dispatch
expects the formulas and contexts to be laid out using local names. Here, we can
use the name <code>fib_square_lemma</code> as the local name of the formula, and
<code>fib_square_lemma!context</code> as the local name of its context. Then, in the
production underlying the assertion we use the local name <code>coq-8.16.1</code> for the
<em>mode</em> field, which is the local name of the DAMF tool object we created in step 4.
The complete assertion is as follows, again as a Dispatch input.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;assertion&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;exampleAgent&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// (1)!</span>
<span class="w">  </span><span class="nt">&quot;claim&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;annotated-production&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;annotation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_lemma&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="c1">// (2)!</span>
<span class="w">    </span><span class="nt">&quot;production&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// (3)!</span>
<span class="w">      </span><span class="nt">&quot;sequent&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;conclusion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_lemma&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// (4)!</span>
<span class="w">        </span><span class="nt">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;formulas&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;fib_square_lemma&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_lemma!context&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// (5)!</span>
<span class="w">      </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;forall n, 2 * n + 27 &lt;= fib (n + 12)&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;contexts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;fib_square_lemma!context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;Require Arith&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;Fixpoint fib (n: nat): nat := match … end&quot;</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<ol>
<li>We made this with <code>dispatch create-agent</code> in step 2.</li>
<li>This defines a possible name for the assertion, but it only serves as a hint
   for consumers. The actual global name is the CID of the DAMF assertion object
   that Dispatch will create. This annotation object can have other metadata
   besides this name himt, such as the Coq proof script. Its structure is not
   prescribed by DAMF.</li>
<li>This is the local name we picked using <code>dispatch create-tool</code> in step 4.</li>
<li>This points to the formula object defined in the <code>"formulas"</code> section below
   (lines 16&ndash;20).</li>
<li>This points to the context object defined in the <code>"contexts"</code> section below
   (lines 23&ndash;29).</li>
</ol>
<p>We can of course ask Dispatch to publish only this assertion. However, since we
have two assertions in this file, it is more convenient for Dispatch to publish
both assertions together as a DAMF collection. Here is what it looks like:</p>
<div class="max30 downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibLemma.v.assertions.json</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;collection&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;FibLemma.v&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;elements&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;assertion&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;exampleAgent&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;claim&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;annotated-production&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;annotation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_lemma&quot;</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nt">&quot;production&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;sequent&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="nt">&quot;conclusion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_lemma&quot;</span><span class="p">,</span>
<span class="w">                      </span><span class="nt">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[]</span>
<span class="w">                  </span><span class="p">}</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;assertion&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;agent&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;exampleAgent&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;claim&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">              </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;annotated-production&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="nt">&quot;annotation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_above&quot;</span>
<span class="w">              </span><span class="p">},</span>
<span class="w">              </span><span class="nt">&quot;production&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                  </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span>
<span class="w">                  </span><span class="nt">&quot;sequent&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">                      </span><span class="nt">&quot;conclusion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_above&quot;</span><span class="p">,</span>
<span class="w">                      </span><span class="nt">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                          </span><span class="s2">&quot;fib_square_lemma&quot;</span>
<span class="w">                      </span><span class="p">]</span>
<span class="w">                  </span><span class="p">}</span>
<span class="w">              </span><span class="p">}</span>
<span class="w">          </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">  </span><span class="p">],</span>
<span class="w">  </span><span class="nt">&quot;formulas&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;fib_square_lemma&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="s2">&quot;fib_square!context&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;forall n, 2 * n + 27 &lt;= fib (n + 12)&quot;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="nt">&quot;fib_square_above&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="s2">&quot;fib_square!context&quot;</span>
<span class="w">          </span><span class="p">],</span>
<span class="w">          </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;forall n, 13 &lt;= n -&gt; n ^ 2 &lt; fib n&quot;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;contexts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;fib_square!context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;coq-8.16.1&quot;</span><span class="p">,</span>
<span class="w">          </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">              </span><span class="s2">&quot;Require Import Arith&quot;</span><span class="p">,</span>
<span class="w">              </span><span class="s2">&quot;Fixpoint fib (n: nat): nat := match n with | 0 =&gt; 0 | S j =&gt; match j with | 0 =&gt; 1 | S k =&gt; fib j + fib k end end&quot;</span>
<span class="w">          </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>We can now use Dispatch to publish the entire collection at once.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>dispatch<span class="w"> </span>publish<span class="w"> </span>FibLemma.v.assertions.json<span class="w"> </span><span class="nb">local</span><span class="w"> </span><span class="c1"># (1)!</span>
<span class="go">Published DAMF collection object to local with cid: bafyreidfn2ub5h5bqkozi5yxsocsoc4s55biabaecfp7jsrmervmpxckei</span>
</code></pre></div>
<ol>
<li><code>local</code> means that it is being published to the local IPFS repository we set up in step 1.</li>
</ol>
<p>This CID can be <a href="https://explore.ipld.io/#/explore/bafyreidfn2ub5h5bqkozi5yxsocsoc4s55biabaecfp7jsrmervmpxckei">explored in IPLD explorer</a>. It can also be locally
explored with <code>ipfs dag get</code>:</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>ipfs<span class="w"> </span>dag<span class="w"> </span>get<span class="w"> </span>bafyreidfn2ub5h5bqkozi5yxsocsoc4s55biabaecfp7jsrmervmpxckei<span class="w"> </span><span class="p">|</span><span class="w"> </span>python<span class="w"> </span>-m<span class="w"> </span>json.tool<span class="w"> </span><span class="c1"># (1)!</span>
<span class="go">{</span>
<span class="go">    &quot;elements&quot;: [</span>
<span class="go">        {</span>
<span class="go">            &quot;/&quot;: &quot;bafyreihkafr7ko4rsvqiafdahsaauv4t7in3qpjdxxvu4puupl2odjxfwi&quot;</span>
<span class="go">        },</span>
<span class="go">        {</span>
<span class="go">            &quot;/&quot;: &quot;bafyreibrzv44jglcptuuiiol3spglqr5i2ttadwg2tvueyjedbpf5v3p5a&quot;</span>
<span class="go">        }</span>
<span class="go">    ],</span>
<span class="go">    &quot;format&quot;: &quot;collection&quot;,</span>
<span class="go">    &quot;name&quot;: &quot;FibLemma.v&quot;</span>
<span class="go">}</span>

<span class="gp">$ </span>ipfs<span class="w"> </span>dag<span class="w"> </span>get<span class="w"> </span>bafyreidfn2ub5h5bqkozi5yxsocsoc4s55biabaecfp7jsrmervmpxckei/elements/0/claim/production/sequent/conclusion/content
<span class="go">&quot;forall n, 2 * n + 27 &lt;= fib (n + 12)&quot;</span>
</code></pre></div>
<ol>
<li><code>python -m json.tool</code> is being used to pretty-print the JSON</li>
</ol>
<h2 id="computations-with-prolog">Computations with λProlog</h2>
<p>Another way of building assertions is by means of a computational engine. Here
we will give the example of using λProlog to perform computations on natural
numbers.  Coq is of course more than capable of doing these computations by
itself, so the purpose of this section is mainly to illustrate how we can
incorporate assertions from different sources.</p>
<h3 id="6-logic-programming">6. Logic programming</h3>
<p>Like with Coq earlier, let us quickly sketch how we are going to represent and
compute with natural numbers in λProlog. We declare <code>nat</code> as a new type with the
<code>kind</code> keyword in the signature, then declare two constants <code>z</code> and <code>s</code> as the
constructors of <code>nat</code>. Note that λProlog operates under the <em>open world
assumption</em>, so there is no way to declare that these are the only two
constructors for <code>nat</code>. The signature also declares three <em>predicates</em>, which
are constants with target type <code>o</code>, which is the type of λProlog formulas.
Here are the signature (<code>fib.sig</code>) and module (<code>fib.mod</code>) files.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Signature</label><label for="__tabbed_1_2">Module</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">fib.sig</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">sig</span> <span class="no">fib</span><span class="p">.</span>
<span class="k">kind</span> <span class="no">nat</span>    <span class="k">type</span><span class="p">.</span>
<span class="k">type</span> <span class="no">z</span>      <span class="no">nat</span><span class="p">.</span>
<span class="k">type</span> <span class="no">s</span>      <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="no">nat</span><span class="p">.</span>
<span class="k">type</span> <span class="no">plus</span>   <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="kt">o</span><span class="p">.</span>
<span class="k">type</span> <span class="no">times</span>  <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="kt">o</span><span class="p">.</span>
<span class="k">type</span> <span class="no">fib</span>    <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="no">nat</span> <span class="kt">-&gt;</span> <span class="kt">o</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">fib.mod</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">module</span> <span class="no">fib</span><span class="p">.</span>
<span class="no">plus</span> <span class="no">z</span> <span class="nv">X</span> <span class="nv">X</span><span class="p">.</span>
<span class="no">plus</span> <span class="p">(</span><span class="no">s</span> <span class="nv">X</span><span class="p">)</span> <span class="nv">Y</span> <span class="p">(</span><span class="no">s</span> <span class="nv">Z</span><span class="p">)</span> <span class="o">:-</span> <span class="no">plus</span> <span class="nv">X</span> <span class="nv">Y</span> <span class="nv">Z</span><span class="p">.</span>
<span class="no">times</span> <span class="no">z</span> <span class="nv">X</span> <span class="no">z</span><span class="p">.</span>
<span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="nv">X</span><span class="p">)</span> <span class="nv">Y</span> <span class="nv">Z</span> <span class="o">:-</span> <span class="no">times</span> <span class="nv">X</span> <span class="nv">Y</span> <span class="nv">U</span><span class="o">,</span> <span class="no">plus</span> <span class="nv">Y</span> <span class="nv">U</span> <span class="nv">Z</span><span class="p">.</span>
<span class="no">fib</span> <span class="no">z</span> <span class="no">z</span><span class="p">.</span>
<span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">).</span>
<span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="nv">X</span><span class="p">))</span> <span class="nv">Y</span> <span class="o">:-</span> <span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="nv">X</span><span class="p">)</span> <span class="nv">U</span><span class="o">,</span> <span class="no">fib</span> <span class="nv">X</span> <span class="nv">V</span><span class="o">,</span> <span class="no">plus</span> <span class="nv">U</span> <span class="nv">V</span> <span class="nv">Y</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p>We will use the <a href="https://github.com/teyjus/teyjus">Teyjus</a> implementation of
λProlog, which compiles a module (a <code>.sig</code>/<code>.mod</code> pair) to bytecode that can be
executed using a bytecode interpreter. To compile the above module <code>fib</code>, we run:</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>tjcc<span class="w"> </span>fib<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>tjlink<span class="w"> </span>fib
</code></pre></div>
<p>Then, we can execute queries against <code>fib</code> by using <code>tjsim</code>.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>tjsim<span class="w"> </span>fib
<span class="go">Welcome to Teyjus</span>
<span class="go">⋮</span>
<span class="go">[fib] ?- fib (s (s (s (s (s (s z)))))) X.</span>

<span class="go">The answer substitution:</span>
<span class="go">X = s (s (s (s (s (s (s (s z)))))))</span>

<span class="go">More solutions (y/n)? n</span>

<span class="go">yes</span>

<span class="go">[fib] ?-</span>
</code></pre></div>
<p>It is also possible to run <code>tjsim</code> in batch (non-interactive) mode, where the
query is specified in the command line.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>tjsim<span class="w"> </span>-b<span class="w"> </span>-m<span class="w"> </span><span class="m">1</span><span class="w"> </span>-s<span class="w"> </span><span class="s1">&#39;fib (s (s (s (s (s (s z)))))) X.&#39;</span><span class="w"> </span>fib<span class="w"> </span><span class="c1"># (1)!</span>

<span class="go">The answer substitution:</span>
<span class="go">X = s (s (s (s (s (s (s (s z)))))))</span>
</code></pre></div>
<ol>
<li><strong>b</strong>atch mode, <strong>m</strong>aximum one solution, <strong>s</strong>olve query</li>
</ol>
<h3 id="7-exporting-to-damf">7. Exporting to DAMF</h3>
<p>We use the following language and tool descriptions for λProlog and Teyjus (version 2.1.1):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Language</label><label for="__tabbed_2_2">Tool</label><label for="__tabbed_2_3">Dispatch commands</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">lprolog.language.content.json</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;λProlog&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://www.lix.polytechnique.fr/~dale/lProlog/&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">teyjus-2.1.1.tool.content.json</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Teyjus&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2.1.1&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;url&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;https://github.com/teyjus/teyjus/archive/refs/tags/v2.1.1.tar.gz&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;sha256&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;a8fafe8ab7cd857a3f46ab8e4a7f76f9f3fac2169fdb72f95b84d1d0bcdf66f9&quot;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>dispatch<span class="w"> </span>create-language<span class="w"> </span>lprolog<span class="w"> </span>json<span class="w"> </span>lprolog.language.content.json
<span class="go">Language record lprolog created successfully!</span>

<span class="gp">$ </span>dispatch<span class="w"> </span>create-tool<span class="w"> </span>teyjus-2.1.1<span class="w"> </span>json<span class="w"> </span>teyjus-2.1.1.tool.content.json
<span class="go">Tool profile teyjus-2.1.1 created successfully!</span>
</code></pre></div>
</div>
</div>
</div>
<p>To build the DAMF assertions, we can use the following <em>harness</em> module:
<a href="example-files/harness.sig"><tt>harness.sig</tt></a> and
<a href="example-files/harness.mod"><tt>harness.mod</tt></a>.  The purpose of the harness
module is to turn a sequence of goals for a module <code>FILE</code>, written in a file
<code>FILE.goals</code>, into a JSON file <code>FILE.json</code> that can be given to <code>dispatch
publish</code>. Note that the agent, language, and tool names that we chose with
<code>dispath create-agent</code>, <code>dispatch create-language</code>, and <code>dispatch create-tool</code>
respectively, are directly written in the harness module.</p>
<p>To use the harness, we define a module <code>main</code> that accumulates and compiles the
<code>fib</code> and <code>harness</code> modules.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Signature</label><label for="__tabbed_3_2">Module</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">main.sig</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">sig</span> <span class="no">main</span><span class="p">.</span>
<span class="k">accum_sig</span> <span class="no">fib</span><span class="p">.</span>
<span class="k">accum_sig</span> <span class="no">harness</span><span class="p">.</span>
<span class="k">type</span> <span class="no">damf_export</span> <span class="kt">o</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">main.mod</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">module</span> <span class="no">main</span><span class="p">.</span>
<span class="k">accumulate</span> <span class="no">fib</span><span class="p">.</span>
<span class="k">accumulate</span> <span class="no">harness</span><span class="p">.</span>
<span class="no">damf_export</span> <span class="o">:-</span> <span class="no">json</span> <span class="s2">&quot;fib&quot;</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
</div>
</div>
</div>
<p>The file <code>fib.goals</code> is a list of goals, with each goal wrapped in a name using
the <code>name</code> predicate. For our purposes, we can just list goals that compute
<span class="arithmatex">\(\kop{fib}(n)\)</span> and <span class="arithmatex">\(n^2\)</span> for <span class="arithmatex">\(n\)</span> between 1 and 13.</p>
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">fib.goals</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="no">name</span> <span class="s2">&quot;sq1&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq2&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq3&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq4&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq5&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq6&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq7&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq8&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq9&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq10&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq11&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq12&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;sq13&quot;</span> <span class="p">(</span><span class="no">times</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))))))</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib1&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib2&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib3&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib4&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib5&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib6&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib7&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib8&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib9&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib10&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib11&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib12&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">))))))))))))</span> <span class="nv">X</span><span class="p">).</span>
<span class="no">name</span> <span class="s2">&quot;fib13&quot;</span> <span class="p">(</span><span class="no">fib</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="p">(</span><span class="no">s</span> <span class="no">z</span><span class="p">)))))))))))))</span> <span class="nv">X</span><span class="p">).</span>
</code></pre></div></td></tr></table></div>
<p>Finally, here&rsquo;s how we can run <code>harness</code>, and subsequently Dispatch:</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>tjcc<span class="w"> </span>fib<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>tjcc<span class="w"> </span>harness<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>tjcc<span class="w"> </span>main<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>tjlink<span class="w"> </span>main

<span class="gp">$ </span>tjsim<span class="w"> </span>-b<span class="w"> </span>-s<span class="w"> </span><span class="s1">&#39;damf_export.&#39;</span><span class="w"> </span>-m<span class="w"> </span><span class="m">1</span><span class="w"> </span>main
<span class="go">Wrote fib.json.</span>

<span class="gp">$ </span>dispatch<span class="w"> </span>publish<span class="w"> </span>fib.json<span class="w"> </span><span class="nb">local</span><span class="w"> </span><span class="c1"># (1)!</span>
<span class="go">Published DAMF collection object to local with cid: bafyreihrmkxxhjx3bppen3ar7pjdakakw2xm55daq6xlnaxsluv4thnfcm</span>
</code></pre></div>
<ol>
<li>Can take a few dozen seconds to finish.</li>
</ol>
<p>This CID can be <a href="https://explore.ipld.io/#/explore/bafyreihrmkxxhjx3bppen3ar7pjdakakw2xm55daq6xlnaxsluv4thnfcm">explored on IPLD explorer</a> or locally with <code>ipfs dag get</code>.</p>
<h2 id="theorem-in-abella-damf">Theorem in Abella DAMF</h2>
<p>The assertions generated by Coq and λProlog will be used to prove the main
theorem in <a href="abella.html">Abella DAMF</a>, which is a variant of the <a href="https://abella-prover.org/">Abella theorem
prover</a> that can accept and publish DAMF assertions.</p>
<p>Abella is simply typed and its type system does not have any reasoning
principles that yield theorems. Reasoning in Abella is done with its <em>reasoning
logic</em> known as <span class="arithmatex">\(\mathcal{G}\)</span>, which is an extension of first-order
intuitionistic logic over <span class="arithmatex">\(\lambda\)</span>-terms that supports inductive and
co-inductive definitions, generic quantification (using <span class="arithmatex">\(\nabla\)</span>), and nominal
abstraction (a generalization of <span class="arithmatex">\(\alpha\beta\eta\)</span> equality on <span class="arithmatex">\(\lambda\)</span>-terms).</p>
<h3 id="8-setting-the-stage">8. Setting the stage</h3>
<p>We will write the overall theorem in the Abella file
<a href="example-files/FibTheorem.thm"><tt>FibTheorem.thm</tt></a>. It begins by defining
the type <code>nat</code> of natural numbers, its constructors <code>z</code> and <code>s</code>, and then some
comparison relations and computations. Note that all definitions in Abella are
relational: unlike Coq, we don&rsquo;t define <code>+</code> as a binary function on natural
numbers but as a ternary relation <code>plus</code> that relates its first two arguments to
its third.</p>
<div class="downloadable highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibTheorem.thm</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">Kind</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="k">type</span><span class="p">.</span>
<span class="kd">Type</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="no">nat</span><span class="p">.</span>
<span class="kd">Type</span><span class="w"> </span><span class="no">s</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="p">.</span>

<span class="kd">Define</span><span class="w"> </span><span class="no">nat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="kt">prop</span><span class="w"> </span><span class="kd">by</span>
<span class="o">;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">z</span>
<span class="o">;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">X</span><span class="p">)</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="nv">X</span><span class="p">.</span>

<span class="kd">Define</span><span class="w"> </span><span class="no">lt</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="kt">prop</span><span class="w"> </span><span class="kd">by</span>
<span class="o">;</span><span class="w"> </span><span class="no">lt</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">X</span><span class="p">)</span>
<span class="o">;</span><span class="w"> </span><span class="no">lt</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">X</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">Y</span><span class="p">)</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="no">lt</span><span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="nv">Y</span><span class="p">.</span>

<span class="kd">Define</span><span class="w"> </span><span class="no">leq</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="kt">prop</span><span class="w"> </span><span class="kd">by</span>
<span class="o">;</span><span class="w"> </span><span class="no">leq</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="nv">X</span>
<span class="o">;</span><span class="w"> </span><span class="no">leq</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">X</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">Y</span><span class="p">)</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="no">leq</span><span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="nv">Y</span><span class="p">.</span>

<span class="kd">Define</span><span class="w"> </span><span class="no">plus</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="kt">prop</span><span class="w"> </span><span class="kd">by</span>
<span class="o">;</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="nv">X</span>
<span class="o">;</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">X</span><span class="p">)</span><span class="w"> </span><span class="nv">Y</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">Z</span><span class="p">)</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="nv">Y</span><span class="w"> </span><span class="nv">Z</span><span class="p">.</span>

<span class="kd">Define</span><span class="w"> </span><span class="no">times</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="kt">prop</span><span class="w"> </span><span class="kd">by</span>
<span class="o">;</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="no">z</span>
<span class="o">;</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">X</span><span class="p">)</span><span class="w"> </span><span class="nv">Y</span><span class="w"> </span><span class="nv">Z</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="k">exists</span><span class="w"> </span><span class="nv">U</span><span class="o">,</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="nv">Y</span><span class="w"> </span><span class="nv">U</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="nv">U</span><span class="w"> </span><span class="nv">Y</span><span class="w"> </span><span class="nv">Z</span><span class="p">.</span>

<span class="kd">Define</span><span class="w"> </span><span class="no">fib</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="kt">prop</span><span class="w"> </span><span class="kd">by</span>
<span class="o">;</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="no">z</span>
<span class="o">;</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="no">z</span><span class="p">)</span>
<span class="o">;</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">X</span><span class="p">))</span><span class="w"> </span><span class="nv">K</span><span class="w"> </span><span class="p">:=</span>
<span class="w">    </span><span class="k">exists</span><span class="w"> </span><span class="nv">M</span><span class="w"> </span><span class="nv">N</span><span class="o">,</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="nv">X</span><span class="w"> </span><span class="nv">M</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="w"> </span><span class="nv">X</span><span class="p">)</span><span class="w"> </span><span class="nv">N</span><span class="w"> </span><span class="o">/\</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="nv">M</span><span class="w"> </span><span class="nv">N</span><span class="w"> </span><span class="nv">K</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
<p>Because all inductive definitions are relational in Abella, we often need
additional lemmas to establish that the relations behave like functions. In our
theorem we will need the following lemmas of this kind.</p>
<div class="continued highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibTheorem.thm</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">Theorem</span><span class="w"> </span><span class="no">plus_deterministic</span><span class="s s-Atom">:</span><span class="w"> </span><span class="k">forall</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">u</span><span class="w"> </span><span class="no">v</span><span class="o">,</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">u</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">v</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">v</span><span class="p">.</span>
<span class="nf">induction</span><span class="w"> </span><span class="nf">on</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nf">intros</span><span class="p">.</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">H1</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="nv">IH</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H3</span><span class="w"> </span><span class="o">*</span><span class="nv">H4</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>

<span class="kd">Theorem</span><span class="w"> </span><span class="no">times_deterministic</span><span class="s s-Atom">:</span><span class="w"> </span><span class="k">forall</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">u</span><span class="w"> </span><span class="no">v</span><span class="o">,</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">u</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">v</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">v</span><span class="p">.</span>
<span class="nf">induction</span><span class="w"> </span><span class="nf">on</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nf">intros</span><span class="p">.</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">H1</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="nv">IH</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H3</span><span class="w"> </span><span class="o">*</span><span class="nv">H5</span><span class="p">.</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="no">plus_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H4</span><span class="w"> </span><span class="o">*</span><span class="nv">H6</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>

<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="s s-Atom">:</span><span class="w"> </span><span class="k">forall</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">u</span><span class="o">,</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">u</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">u</span><span class="p">.</span>
<span class="nf">induction</span><span class="w"> </span><span class="nf">on</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nf">intros</span><span class="p">.</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">H1</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span>
<span class="w">    </span><span class="nf">apply</span><span class="w"> </span><span class="nv">IH</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H3</span><span class="w"> </span><span class="o">*</span><span class="nv">H6</span><span class="p">.</span>
<span class="w">    </span><span class="nf">apply</span><span class="w"> </span><span class="nv">IH</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H4</span><span class="w"> </span><span class="o">*</span><span class="nv">H7</span><span class="p">.</span>
<span class="w">    </span><span class="nf">apply</span><span class="w"> </span><span class="no">plus_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H5</span><span class="w"> </span><span class="o">*</span><span class="nv">H8</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>

<span class="kd">Theorem</span><span class="w"> </span><span class="no">lt_irreflexive</span><span class="s s-Atom">:</span><span class="w"> </span><span class="k">forall</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">lt</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="kc">false</span><span class="p">.</span>
<span class="nf">induction</span><span class="w"> </span><span class="nf">on</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="w"> </span><span class="nf">intros</span><span class="p">.</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">H1</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H2</span><span class="p">.</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="nv">IH</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H3</span><span class="w"> </span><span class="o">*</span><span class="nv">H4</span><span class="p">.</span>

<span class="kd">Theorem</span><span class="w"> </span><span class="no">plus_result_nat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="k">forall</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">k</span><span class="o">,</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">plus</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">k</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">k</span><span class="p">.</span>
<span class="nf">induction</span><span class="w"> </span><span class="nf">on</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nf">intros</span><span class="p">.</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">H3</span><span class="p">.</span>
<span class="w">  </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H1</span><span class="p">.</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="nv">IH</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H5</span><span class="w"> </span><span class="o">*</span><span class="nv">H2</span><span class="w"> </span><span class="o">*</span><span class="nv">H4</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>

<span class="kd">Theorem</span><span class="w"> </span><span class="no">times_result_nat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="k">forall</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">k</span><span class="o">,</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">k</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">k</span><span class="p">.</span>
<span class="nf">induction</span><span class="w"> </span><span class="nf">on</span><span class="w"> </span><span class="mi">3</span><span class="p">.</span><span class="w"> </span><span class="nf">intros</span><span class="p">.</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">H3</span><span class="p">.</span>
<span class="w">  </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">H1</span><span class="p">.</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="nv">IH</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H6</span><span class="w"> </span><span class="nv">H2</span><span class="w"> </span><span class="o">*</span><span class="nv">H4</span><span class="p">.</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="no">plus_result_nat</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="o">*</span><span class="nv">H7</span><span class="w"> </span><span class="o">*</span><span class="nv">H2</span><span class="w"> </span><span class="o">*</span><span class="nv">H5</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
<h3 id="9-importing-damf-assertions">9. Importing DAMF assertions</h3>
<p>Abella can import any DAMF assertion using the following statement:</p>
<div class="highlight"><pre><span></span><code><span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:&lt;cid&gt;&quot;</span><span class="p">.</span>
</code></pre></div>
<p>Here, <code>&lt;cid&gt;</code> can be the CID of an individual DAMF assertion object or a DAMF
collection object containing assertions. If these assertion objects are in
Abella&rsquo;s own language, they can be used as is. For reference, Abella&rsquo;s DAMF
language object has the following CID:</p>
<div class="highlight"><pre><span></span><code>bafyreiga2dpaxobxqvvy2akl2frrap2xzw5xrq2olpfnv5q5e362vaua5q
</code></pre></div>
<p>What about the case of DAMF assertions in a different language? In this case,
Abella will need to use an <em>adapter sequent</em> as explained in the <a href="https://doi.org/10.1007/978-3-031-43369-6_10">DAMF technical
design paper</a>. In the future, such adapter
sequents will be built using language translation tools. For now, we will write
the adapter sequents ourselves and sign the resulting assertions using a <code>mode</code>
field of <code>null</code>, which stands for an assertion for which the signing agent is
wholly responsible.</p>
<p>To create such adapter sequents, Abella has a modified form of the <code>Import
... as</code> statement that allows the user to restate the theorem in Abella&rsquo;s own
language.  For example, the theorem <code>fib_square_above</code> from Coq that was
exported in step 5 can be imported in Abella as follows:</p>
<div class="continued highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibTheorem.thm</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreibrzv44jglcptuuiiol3spglqr5i2ttadwg2tvueyjedbpf5v3p5a&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib_square_above</span><span class="s s-Atom">:</span><span class="w"> </span><span class="k">forall</span><span class="w"> </span><span class="no">x</span><span class="o">,</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="kt">-&gt;</span>
<span class="w">  </span><span class="no">leq</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">13</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="kt">-&gt;</span>
<span class="w">  </span><span class="k">forall</span><span class="w"> </span><span class="no">y</span><span class="o">,</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="kt">-&gt;</span>
<span class="w">  </span><span class="k">forall</span><span class="w"> </span><span class="no">u</span><span class="o">,</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">u</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">lt</span><span class="w"> </span><span class="no">y</span><span class="w"> </span><span class="no">u</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
<p>The statement of this theorem needs to be comprehensible in the local context of
the Abella development, using the type <code>nat</code>, constants <code>s</code> and <code>z</code>, and the
relations <code>times</code>, <code>fib</code>, <code>lt</code>, etc. defined in lines 1&ndash;29 of
<tt>FibTheorem.thm</tt>.</p>
<div class="admonition info">
<p class="admonition-title">Iterated application notation</p>
<p>The term <code>s^13 z</code> stands for the term
<code>(s (s (s (s (s (s (s (s (s (s (s (s (s z)))))))))))))</code>,
which is 13 in the unary representation of <code>nat</code>. For any unary term
constant <code>k</code> and literal number <code>n</code> (<span class="arithmatex">\(\ge 0\)</span>), the notation <code>(k^n t)</code>
stands for the <code>n</code>-times iterated application of <code>k</code> to <code>t</code>.</p>
</div>
<p>After type-checking the statement of the theorem, Abella uses this <code>Import
... as</code> statement first to build the adapter sequent that has the following DAMF
structure:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span><span class="w"> </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;assertion&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;claim&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;format&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;annotated-production&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;annotation&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="nt">&quot;fib_square_above!adapter&quot;</span>
<span class="w">      </span><span class="nt">&quot;generator&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;damf:bafyreiehnznomgmy3u724hk4jhhkvsnwgoavyva5kbxoeqfhl5epn6ev6a&quot;</span><span class="w"> </span><span class="c1">// (1)!</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;production&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;sequent&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;conclusion&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_above&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;dependencies&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">          </span><span class="s2">&quot;damf:bafyreibrzv44jglcptuuiiol3spglqr5i2ttadwg2tvueyjedbpf5v3p5a/claim/production/sequent/conclusion&quot;</span><span class="w"> </span><span class="c1">// (2)!</span>
<span class="w">        </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="w">  </span><span class="nt">&quot;formulas&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;fib_square_above&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;damf:bafyreiga2dpaxobxqvvy2akl2frrap2xzw5xrq2olpfnv5q5e362vaua5q&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// (3)!</span>
<span class="w">      </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;forall x, nat x -&gt; … -&gt; lt y u&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fib_square_above!context&quot;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;contexts&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;fib_square_above!context&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;language&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;damf:bafyreiga2dpaxobxqvvy2akl2frrap2xzw5xrq2olpfnv5q5e362vaua5q&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;Kind nat type&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Type z nat&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Type s nat -&gt; nat&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;Define nat : …&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Define leq : …&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Define lt : …&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;Define times : …&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Define fib : …&quot;</span>
<span class="w">      </span><span class="p">]</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</code></pre></div>
<ol>
<li>This field links to the DAMF tool object for this version of Abella. Because
   it is part of an annotation, DAMF prescribes no particular meaning to the
   <code>"generator"</code> key or its value. Its purpose in this walkthrough is purely
   documentary in nature.</li>
<li>This uses IPLD paths to refer to the CID of the <code>conclusion</code> of the assertion
   object that was imported. It corresponds to the theorem named <code>fib_square_above</code>
   that we proved in Coq.</li>
<li>This is the Abella language&rsquo;s identifier</li>
</ol>
<p>This adapter sequent, which has a dependency on an external formula in a
different language (Coq) to the conclusion (Abella), will be published using
Dispatch. For the rest of the file, Abella then continues as if
<code>fib_square_lemma</code> was indeed stated and proved in Abella.</p>
<p>The assertions produced using λProlog in step 7 are similarly imported using a
sequence of <code>Import ... as</code> statements.</p>
<div class="continued max30 highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibTheorem.thm</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreigw52p4flvo7wnp4bl7kdkkqjo5opn6xv6g3onhj5obzjheqbvoki&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq1</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">1</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">1</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">1</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreic6sswb47edfafdwkp6i6nhx64dp4exalvxkodzv4vupwxlrsykxa&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq2</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">4</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreiadawlvj3272a6xmouks2bmxhlxtxuunfpdrgsoqiw7gyhlmaealu&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq3</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">9</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreig2raf6r3rcv4wktejcwsyk7lpzixcxrhmkafsw4gxkb6tpeoz7ve&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq4</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">4</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">4</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">16</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreidtm2iwx57w3ym464gmorbevswlwuqeinenfwi475grylzwbmgnj4&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq5</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">5</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">5</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">25</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreihk7wrmsnh3rrbwuc36xpdzam5t7sp2cbegn4xopws4t6v7zzacmy&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq6</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">6</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">6</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">36</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreiffos2a3aurvv62h6hvwthhzvxr6ljpikqvooeli6qhfj5x2o5kau&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq7</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">7</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">7</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">49</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreifxjknfmxtxfevdpa2sb5niuieozskorks572q6ci5mwdltheq4iu&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq8</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">8</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">8</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">64</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreih7k5n5eupjusle7e4flnmwwfugdmjabgfxhlbvdfogog3zpj4nge&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq9</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">9</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">9</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">81</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreia3u5ilcqgmknoxmyenmbcg6zs5dpn4gb4mgekvayg7sapuyczpba&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq10</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">10</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">10</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">100</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreihh3u5odbn7b6mg7gj5kbddgx24vmzsk3s7fl4pbwpt3vt5tozgum&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq11</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">11</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">11</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">121</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreidowzhpu4awe2ikqcvezgvt5alayzuggjdjfv2cml5lvjdqgb5hgm&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq12</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">12</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">12</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">144</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreiah3ozon7snoeoda4d7k6jomkxxpc7zkdbqdpmuunswmcnl4ti6hi&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">sq13</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">13</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">13</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">169</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreihgsvb4j6yqywfpglosxiqf5lestlunnt4dofh7hu7o57ysc3prqa&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib2</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">1</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreiarvy76rs6dhno2bb2td65afej65qcffwzvv6yma6adck7jart5ta&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib3</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreiajt7jdw5edowkckjgzx6oywcu2nqlkvwj44jwfutyid47236riaq&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib4</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">4</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreifudehu2yowq7inyl76xbe4mh373bkdxxjx5x7xyeo6kttqdu7gii&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib5</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">5</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">5</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreia3r2yuaf7mlzev23mbrnbhqpv4mt7poy6rutnluixbrhkziodyrm&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib6</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">6</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">8</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreibuyhtzhqiat4xxfcl2ih2ody5vlib4az3vtlktpfymm6iday6zu4&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib7</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">7</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">13</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreia33kwqu63c4u7d5aigobablwcluebfto6xovlthiy4jqwwkswlyi&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib8</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">8</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">21</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreid5ktnm355nffj7sgmdcgclsnfxuuoqedyzexapzcns3gvvpaut5a&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib9</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">9</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">34</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreigqjhcvo2vrhlntnx5gbiirbq3qjszpgj5mjixu2ycgzf7v3kskfy&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib10</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">10</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">55</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreifmla2g6h4nwp226jl34i5zopiwcjyooq2t2z3vo26axfnlls7mdq&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib11</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">11</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">89</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreiejcs3d2cyfg32thgza3gadx73po5ajnzbkckxhsooj2k22o3q5ry&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib12</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">12</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">144</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>

<span class="k">Import</span><span class="w"> </span><span class="s">&quot;damf:bafyreigwivd6ymclghz3oav3uvgs4avadyhxyswbj7w364v2c5olzfsxje&quot;</span><span class="w"> </span><span class="k">as</span>
<span class="kd">Theorem</span><span class="w"> </span><span class="no">fib13</span><span class="s s-Atom">:</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">13</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">233</span><span class="w"> </span><span class="no">z</span><span class="p">).</span>
</code></pre></div></td></tr></table></div>
<h3 id="10-finishing-the-theorem">10. Finishing the theorem</h3>
<p>Assembling the final theorem in Abella is now straightforward. In the <em>only if</em>
direction (forward), we repeatedly make use of the computation assertions from
λProlog for <span class="arithmatex">\(n \in 0..12\)</span>, and then the <code>fib_square_above</code> assertion for <span class="arithmatex">\(n \ge
13\)</span>. In the <em>if</em> direction, we just verify that the computations (again, pulled
from λProlog) have the right values.</p>
<div class="continued highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">FibTheorem.thm</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">Theorem</span><span class="w"> </span><span class="no">fib_squares</span><span class="s s-Atom">:</span><span class="w"> </span><span class="k">forall</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">x2</span><span class="o">,</span><span class="w"> </span><span class="no">nat</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">times</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">x2</span><span class="w"> </span><span class="kt">-&gt;</span>
<span class="w">  </span><span class="p">(</span><span class="no">fib</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">x2</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">12</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="o">/\</span>
<span class="w">  </span><span class="p">(</span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">12</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="kt">-&gt;</span><span class="w"> </span><span class="no">fib</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="no">x2</span><span class="p">).</span>
<span class="nf">intros</span><span class="w"> </span><span class="nv">Hnat</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span><span class="w"> </span><span class="nf">split</span><span class="p">.</span>
<span class="c1">%% -&gt;</span>
<span class="nf">intros</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="nv">Hcs</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">assert</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">0</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">1</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">2</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">3</span><span class="w"> </span><span class="no">z</span>
<span class="w">         </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">4</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">5</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">6</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">7</span><span class="w"> </span><span class="no">z</span>
<span class="w">         </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">8</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">9</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">10</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">11</span><span class="w"> </span><span class="no">z</span>
<span class="w">         </span><span class="o">\/</span><span class="w"> </span><span class="no">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">s</span><span class="o">^</span><span class="mi">12</span><span class="w"> </span><span class="no">z</span><span class="w"> </span><span class="o">\/</span><span class="w"> </span><span class="no">leq</span><span class="w"> </span><span class="p">(</span><span class="no">s</span><span class="o">^</span><span class="mi">13</span><span class="w"> </span><span class="no">z</span><span class="p">)</span><span class="w"> </span><span class="no">x</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hnat</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">right</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="w"> </span><span class="mi">14</span><span class="p">.</span>
<span class="nv">Hcs</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hcs</span><span class="p">.</span>
<span class="w">  </span><span class="nf">search</span><span class="p">.</span><span class="w"> </span><span class="c1">% case of x = z</span>
<span class="w">  </span><span class="nf">search</span><span class="p">.</span><span class="w"> </span><span class="c1">% case of x = s z</span>
<span class="w">  </span><span class="c1">% case of x = 2</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib2</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq2</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 3</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib3</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq3</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 4</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib4</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq4</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 5</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib5</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq5</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 6</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib6</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq6</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 7</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib7</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq7</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 8</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib8</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq8</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 9</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib9</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq9</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 10</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib10</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq10</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 11</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">fib11</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq11</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x = 12</span>
<span class="w">  </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="c1">% case of x &gt;= 13</span>
<span class="w">  </span><span class="nv">H</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="no">fib_square_above</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="nv">Hnat</span><span class="w"> </span><span class="nv">Hcs</span><span class="p">.</span>
<span class="w">  </span><span class="nv">H</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="o">*</span><span class="nv">H</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="nv">H</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="o">*</span><span class="nv">H</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="nv">Hfib</span><span class="p">.</span>
<span class="w">  </span><span class="nv">Hnat2</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_result_nat</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="nv">Hnat</span><span class="w"> </span><span class="nv">Hnat</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">lt_irreflexive</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="nv">Hnat2</span><span class="w"> </span><span class="nv">H</span><span class="p">.</span>

<span class="c1">%% &lt;-</span>
<span class="nf">intros</span><span class="w"> </span><span class="nv">Hcs</span><span class="p">.</span>
<span class="nv">Hcs</span><span class="s s-Atom">:</span><span class="w"> </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hcs</span><span class="p">.</span>
<span class="w">  </span><span class="nf">case</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq1</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span><span class="w"> </span><span class="nf">search</span><span class="p">.</span>
<span class="w">  </span><span class="nf">apply</span><span class="w"> </span><span class="no">times_deterministic</span><span class="w"> </span><span class="nf">to</span><span class="w"> </span><span class="no">sq12</span><span class="w"> </span><span class="nv">Hsquare</span><span class="p">.</span><span class="w"> </span><span class="nf">backchain</span><span class="w"> </span><span class="no">fib12</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
<p>Verifying this in Abella requires the <code>--damf-imports</code> command line
flag. Publishing the assertions also requires the <code>--damf-publish &lt;location&gt;</code>
flag, where <code>&lt;location&gt;</code> is either <code>local</code> or <code>cloud</code>.</p>
<div class="conbox highlight"><pre><span></span><code><span class="gp">$ </span>abella<span class="w"> </span>--damf-imports<span class="w"> </span>--damf-publish<span class="w"> </span><span class="nb">local</span><span class="w"> </span>FibTheorem.thm
<span class="go">Published as damf:bafyreibdopn2ak2x4xadwxhqba4ikoweylu5qewbnds47iy7cweqsfyzde</span>
</code></pre></div>
<p>As usual, this can be <a href="https://explore.ipld.io/#/explore/bafyreibdopn2ak2x4xadwxhqba4ikoweylu5qewbnds47iy7cweqsfyzde">browsed in IPLD explorer</a>. This link refers to the whole collection of assertions generated by the above <code>abella</code> command.</p>
<p>The assertion corresponding to the final <code>fib_squares</code> theorem is the last one of the assertions in the above collection. It can be browsed <a href="https://explore.ipld.io/#/explore/bafyreibdopn2ak2x4xadwxhqba4ikoweylu5qewbnds47iy7cweqsfyzde/elements/32">starting from the collection&rsquo;s root cid</a>.
It can also be accessed <a href="https://explore.ipld.io/#/explore/bafyreigkqofrwb5mhlnee3ercxjw7gxihpsou44unqfglydnco5ifsagkq">directly by its own cid</a>.</p>
<p>Note that, as you try this walkthrough, you will get different <em>assertion</em> <code>cids</code> (and thus a different collection cid) than those included here. This is natural as you would be using a different <code>agent</code> for signatures. However, the <code>cids</code> for the damf objects including formulas, sequents, etc. shall be the same.</p>
<script>
  (async function () {
    for (const el of document.getElementsByClassName("downloadable")) {
      const th = el.getElementsByTagName("th")[0];
      const span = th.getElementsByTagName("span")[0];
      const fileName = span.innerHTML;
      span.innerHTML = `${ fileName } (<a target="_blank" href="./example-files/${ fileName }">download</a>)`;
    }
    for (const el of document.getElementsByClassName("continued")) {
      const th = el.getElementsByTagName("th")[0];
      const span = th.getElementsByTagName("span")[0];
      const fileName = span.innerHTML;
      span.innerHTML = `${ fileName } (contd.)`;
    }
  })();
</script>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="lprolog.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: λProlog">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                λProlog
              </div>
            </div>
          </a>
        
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 . <a href="https://innofarah.com" target="_blank">Farah Al Wardani</a>, <a href="https://chaudhuri.info" target="_blank">Kaustuv Chaudhuri</a>, and <a href="https://www.lix.polytechnique.fr/~dale/" target="_blank">Dale Miller</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/distributed-assertions" target="_blank" rel="noopener" title="DAMF on github" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "toc.follow", "navigation.top", "navigation.expand", "navigation.footer", "content.code.annotate"], "search": "assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.a7c05c9e.min.js"></script>
      
        <script src="assets/js/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>